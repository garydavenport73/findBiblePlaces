function e(t,n,o,i,a,s,r,d,c){var l=new XMLHttpRequest;d||(l.withCredentials=!0),void 0===c&&(c=2),o=(t.apiHost?t.apiHost:"https://fastcomments.com")+o,l.open(n,o),"POST"!==n&&"DELETE"!==n||l.setRequestHeader("Content-type","application/json"),l.setRequestHeader("Original-Referrer",t.originalReferrer),i?l.send(JSON.stringify(i)):l.send(),l.onload=function(){const m=r?l.responseText:JSON.parse(l.responseText);200!==l.status&&401!==l.status&&422!==l.status&&429!==l.status?c>0&&"GET"===n?setTimeout((function(){c--,e(t,n,o,i,a,s,r,d,c)}),1500*Math.random()):s&&s(m):a&&a(m)},l.onerror=function(){s&&s(l)}}function t(e,t){window.ReactNativeWebView&&window.ReactNativeWebView.postMessage&&window.ReactNativeWebView.postMessage(e),window.parent&&window.parent.postMessage&&window.parent.postMessage(e,t)}function n(e,n,o){t(JSON.stringify({type:"redirect",instanceId:e,url:n,isNewWindow:o}),"*")}function o(e,t){window.parent.postMessage(JSON.stringify({type:"update-height",instanceId:e,height:t}),"*")}function i(e,n){t(JSON.stringify({type:"update-config",instanceId:e,config:n}),"*")}function a(e,n,o,i,a){t(JSON.stringify({type:"vote-success",instanceId:e,comment:n,voteId:o,direction:i,status:a}),"*")}function s(e){t(JSON.stringify({type:"on-render",instanceId:e}),"*")}function r(e,n,o){t(JSON.stringify({type:"on-authentication-change",instanceId:e,changeType:n,data:o}),"*")}function d(e,n){t(JSON.stringify({type:"on-comments-rendered",instanceId:e,comments:n}),"*")}function c(e,t,n,o){let i="";return e.disableToolbar||(i+='<div class="toolbar default-hidden" data-comment-id="'+o+'">',i+='<div class="t-btn" data-action="bold">B</div>',i+='<div class="t-btn" data-action="it">I</div>',i+='<div class="t-btn" data-action="ul">U</div>',i+='<div class="t-btn" data-action="s">S</div>',i+='<div class="t-btn" data-action="code">&lt;/&gt;</div>',i+='<div class="t-btn" data-action="link" title="'+t.t90+'"><img src="/images/link-24.png" alt="'+t.t90+'"></div>',e.noImageUploads||(i+='<div class="t-btn img-btn-wrap"><img src="/images/photo-24.png" alt="'+t.t25+'" title="'+t.t25+'"><input name="file" title="'+t.t25+'" type="file" accept="image/png, image/jpeg, image/gif, image/webp" class="file-input" data-parent-id="'+o+'"></div>'),i+="</div>"),i}function l(e){return e.defaultAvatarSrc?e.defaultAvatarSrc:"/images/unknown-person-v2.png"}function m(e){return'<div class="fastcomments-message-wrapper"><div class="fastcomments-message"><d class="message-text">'+e+'</d><d class="icon bubble-white"></d></div></div>'}const u={"username-taken":"t16","invalid-name":"t17","invalid-name-is-email":"t18"};function p(e,t,n,o,i,a,s,r,d,l,m,p,f,g,v){if(e.readonly)return"";const h=a[f];let b='<form class="comment-reply'+(s[f]?" show-default-hidden":"")+(f?"":" root")+'" data-parent-id="'+f+'"';if(n.forEach(e=>{e.getFormAttributesHTML&&(b+=e.getFormAttributesHTML("comment",o,f))}),b+=">",n.forEach(e=>{e.replyAreaTop&&(b+=e.replyAreaTop(o,h,!!s[f],f))}),null!==f){let e;e=o?t.t158.replace("[to]",l[f].commenterName).replace("[from]",o.username):t.t12.replace("[to]",l[f].commenterName),b+='<div class="replying-to">'+e+"</div>"}if(e.headerHTML&&!f&&(b+=function(e){const t=document.createElement("div");t.innerHTML=e;const n=t.getElementsByTagName("script");let o=n.length;for(;o--;)n[o].parentNode.removeChild(n[o]);return t.innerHTML?t.innerHTML:""}(e.headerHTML)),o||!e.sso||e.allowAnon){o&&(b+='<div class="logged-in-info">'+t.t20+o.username+(!e.sso||e.sso.logoutURL||e.sso.logoutCallback?'. <span class="log-out" data-parent-id="'+f+'">'+t.t21+"</span>":""),r[f]&&(b+=' <span class="fc-red">'+t.t22+"</span>"),b+="</div>"),b+="<div>";{const n=e.useSingleLineCommentInput?"input":"textarea";b+="<"+n+' name="fastcomments-comment" autocomplete="off" class="comment-input" required id="input-for-parent-'+f+'" data-parent-id="'+f+'" data-restore-id="fcc-'+f+'" placeholder="'+t.t23+'" maxlength="'+(e.maxCommentCharacterLength?e.maxCommentCharacterLength:2e3)+'" onfocus="window.fcHandleCommentInputSelected(event)"></'+n+">"}0,b+="</div>",b+=c(e,t,0,f),!o||!0===d[f]||"object"==typeof d[f]&&u[d[f].code]?(b+='<div class="user-info-input auth-input default-hidden">',e.sso&&!e.allowAnon?(e.sso.loginURL||e.sso.loginCallback)&&(b+='<a class="sso-login" '+(e.sso.loginURL?'href="'+e.sso.loginURL+'"':"")+">"+t.t59+"</a>"):(e.sso&&(e.sso.loginURL||e.sso.loginCallback)&&(b+='<a class="sso-login" '+(e.sso.loginURL?'href="'+e.sso.loginURL+'"':"")+">"+t.t71+"</a>"),e.disableEmailInputs||(b+='<div class="reasoning">'+(e.allowAnon?t.t13:t.t14)+"</div>",b+='<input name="fastcomments-email" '+(e.allowAnon?"":"required")+' type="email" id="email-input-for-parent-'+f+'" data-restore-id="fce-'+f+'" placeholder="'+t.t15+'" maxlength="70" />'),b+='<input name="fastcomments-username" required type="text" id="username-input-for-parent-'+f+'" data-restore-id="fcu-'+f+'" placeholder="'+t.t19+'" maxlength="70" '+(e.defaultUsername?'value="'+e.defaultUsername+'"':"")+" />",e.enableCommenterLinks&&(b+='<input name="fastcomments-link" type="url" id="link-input-for-parent-'+f+'" data-restore-id="fcl-'+f+'" placeholder="'+t.t92+'" maxlength="500" />'),d[f]&&u[d[f].code]&&(b+='<div class="fc-red">'+t[u[d[f].code]]+"</div>")),b+="</div>"):o&&(b+='<input name="fastcomments-email" type="hidden" value="'+o.email+'"  />',b+='<input name="fastcomments-username" type="hidden" value="'+o.username+'"  />'),h&&!d[f]||(b+='<button type="submit" data-parent-id="'+f+'" class="fast-comments-reply'+(o?"":" default-hidden")+'">'+t.t24+"</button>"),f&&(b+='<button type="button" data-parent-id="'+f+'" class="fast-comments-reply-cancel default-hidden">'+t.t26+"</button>")}else e.sso.loginURL||e.sso.loginCallback?b+='<div class="sso-login-wrapper"><div class="sso-login" '+(e.sso.loginURL?'href="'+e.sso.loginURL+'"':"")+'><div class="message-text">'+t.t59+"</div></div></div>":b+='<div class="sso-login-text">'+t.t60+"</div>";if(!0===d[f])b+=m;else if("object"==typeof d[f])if("banned"===d[f].code){let e=t.t57;d[f].bannedUntil&&(e+=" "+t.t119.replace("[endsText]",new Date(d[f].bannedUntil).toLocaleString())),b+='<div class="fc-red comment-error">'+e+"</div>"}else"user-rate-limited"===d[f].code?b+='<div class="fc-red comment-error">'+t.t98+"</div>":"blocked"===d[f].code?b+='<div class="fc-red comment-error">'+t.t145+"</div>":t[d[f].code]&&(b+='<div class="fc-red comment-error">'+t[d[f].code]+"</div>");else h&&(b+=p);return b+="</form>",n.forEach(e=>{e.replyAreaFilter&&(b=e.replyAreaFilter(o,h,!!s[f],f,b))}),b}function f(e,t){return t?Number(t).toLocaleString()+" "+(t>1?e.t62:e.t61):""}function g(e,t,n){if(!n.nestedChildrenCount)return"";const o=t[n._id];return'<div class="toggle-replies" data-comment-id="'+n._id+'">'+(o?e.t45+" ("+Number(n.nestedChildrenCount).toLocaleString()+")":e.t46)+"</div>"}function v(e,t,n,o,i,a,s,r){let d="";e.disableVoting||(d+='<div class="comment-votes">'+Number(s.votes<0?-1*s.votes:s.votes).toLocaleString()+" "+(s.votes<0?t.t69:t.t68)+"</div>"),s.errorAlreadyVoted?d+='<div class="fc-red">'+t.t36+"</div>":s.isDeleted||e.disableVoting||(d+='<div class="comment-vote-options">',d+='<span class="fast-comments-upvote upvote'+(s.isVotedUp?" active":"")+'" data-comment-id="'+s._id+'" title="'+t.t37+'">▲</span> ',d+='<span class="fast-comments-downvote downvote'+(s.isVotedDown?" active":"")+'" data-comment-id="'+s._id+'" title="'+t.t38+'">▼</span>',d+="</div>");let c=!1;if(s.pendingAuthVotingDir&&(d+='<form class="comment-vote-auth auth-input">',e.sso&&!e.allowAnon?(e.sso.loginURL||e.sso.loginCallback)&&(d+='<a class="sso-login" '+(e.sso.loginURL?'href="'+e.sso.loginURL+'"':"")+">"+t.t97+"</a>"):(e.sso&&(e.sso.loginURL||e.sso.loginCallback)&&(d+='<a class="sso-login" '+(e.sso.loginURL?'href="'+e.sso.loginURL+'"':"")+">"+t.t71+"</a>"),e.disableEmailInputs||(d+='<div class="reasoning">'+t.t39+"</div>",d+='<input name="fastcomments-email" '+(e.allowAnon?"":"required")+' type="email" id="email-vote-input-for-comment-'+s._id+'" data-restore-id="fcev-'+s._id+'" placeholder="'+t.t41+'" />'),s.voteUsernameTaken&&(d+='<div class="fc-red">'+t.t42+"</div>"),d+='<input name="fastcomments-username" required type="text" id="username-vote-input-for-comment-'+s._id+'" data-restore-id="fcuv-'+s._id+'" placeholder="'+t.t19+'"'+(e.defaultUsername?'value="'+e.defaultUsername+'"':"")+" />",s.voteInProgress&&(c=!0,d+=i),d+='<div class="buttons">',d+='<button class="vote-auth-cancel" data-comment-id="'+s._id+'" type="button">'+t.t43+"</button>",d+='<button class="vote-auth-submit" data-comment-id="'+s._id+'" type="submit">'+t.t44+"</button>",d+="</div>"),d+="</form>"),s.pendingAuthVotingDir||s.isDeleted||e.readonly||(d+='<button class="comment-reply-start" data-comment-id="'+s._id+'">'+t.t47+"</button>"),s.children&&(d+=g(t,o,s)),s.pendingVote&&(d+='<div class="vote-awaiting-verification">'+t.t93+"</div>"),"object"==typeof n[s._id]&&"banned"===n[s._id].code){let e=t.t58;n[s._id].bannedUntil&&(e+=" "+t.t119.replace("[endsText]",new Date(n[s._id].bannedUntil).toLocaleString())),d+='<div class="fc-red">'+e+"</div>"}else n[s._id]?d+=a:!c&&s.voteInProgress&&(d+=i);return d}function h(e,t,n,o,i,a){const s=n._id;let r="";o&&(r+='<div class="menu-edit-comment" data-comment-id="'+s+'"><span>'+e.t75+"</span></div>"),i&&(r+='<div class="menu-pin-comment" data-comment-id="'+s+'">'+(n.isPinned,"<span>")+(n.isPinned?e.t96:e.t95)+"</span></div>"),o&&(r+='<div class="menu-delete-comment" data-comment-id="'+s+'"><span>'+e.t76+"</span></div>"),a&&(r+='<div class="'+(n.isBlocked?"menu-unblock-user":"menu-block-user")+'" data-comment-id="'+s+'"><span>'+(n.isBlocked?e.t142:e.t141)+"</span></div>"),t.forEach(e=>{e.menuBottom&&(r+=e.menuBottom(n))});let d="";return r.length>0?(d+='<div class="menu">',d+='<div class="menu-btn"><i></i><i></i><i></i></div>',d+='<div class="menu-content card goes-black">',d+=r,d+="</div>",d+="</div>"):d='<div class="menu empty"><div class="menu-btn  edit-small" title="No actions available."></div></div>',t.forEach(e=>{e.menuFilter&&(d=e.menuFilter(n,d))}),d}function b(e,t){const n=(Date.now()-t)/1e3,o=Math.floor(n/86400);return isNaN(o)||o<0?"":0===o&&(n<60&&e.t2||n<120&&e.t3||n<3600&&Math.floor(n/60)+e.t4||n<7200&&e.t5||n<86400&&Math.floor(n/3600)+e.t6)||1===o&&e.t7||o<7&&o+e.t8||7===parseInt(o,10)&&e.t100||o<31&&Math.ceil(o/7)+e.t9||o<365&&Math.ceil(o/30)+e.t10||Math.ceil(o/365)+e.t11}function x(e,t,n,o){return e.absoluteAndRelativeDates?b(t,n)+'<span class="abs-date">'+n.toLocaleDateString()+"</span>":e.absoluteDates?o:b(t,n)}function I(e){let t=[];for(const n in e){e[n]&&t.push(n+"="+encodeURIComponent(e[n]))}return"?"+t.join("&")}function y(e,t){let n=e.length;for(;n--;){const o=e[n],i=t(o);if(!1===i)break;if("delete"===i){const t=e.indexOf(o);t>-1&&e.splice(t,1);break}o.children&&y(o.children,t)}}function E(t,n,o,i,a,s){if(n.disableLiveCommenting)return;const r={};a.userIdsToCommentIds={},a.usersOnlineMap={},y(s,(function(e){S(a,e,r)}));const d=Object.keys(r);d.length>0?e(n,"GET","/user-presence-status"+I({tenantId:n.tenantId,urlIdWS:i,userIds:d.join(",")}),null,(function(e){if("success"===e.status&&e.userIdsOnline)for(const i in e.userIdsOnline){const s=e.userIdsOnline[i];a.usersOnlineMap[i]!==s&&(a.usersOnlineMap[i]=s,w(t,n,o,a,i))}a.heartbeatActive||(T(n,i),a.heartbeatActive=!0)})):a.heartbeatActive||(T(n,i),a.heartbeatActive=!0)}function S(e,t,n){t.userId&&(e.userIdsToCommentIds[t.userId]||(e.userIdsToCommentIds[t.userId]=[],n&&void 0===e.usersOnlineMap[t.userId]&&(n[t.userId]=!0)),e.userIdsToCommentIds[t.userId].includes(t._id)||e.userIdsToCommentIds[t.userId].push(t._id)),t.anonUserId&&(e.userIdsToCommentIds[t.anonUserId]||(e.userIdsToCommentIds[t.anonUserId]=[],n&&void 0===e.usersOnlineMap[t.anonUserId]&&(n[t.anonUserId]=!0)),e.userIdsToCommentIds[t.anonUserId].includes(t._id)||e.userIdsToCommentIds[t.anonUserId].push(t._id))}function T(t,n){setTimeout((function o(){e(t,"PUT","/user-presence-heartbeat"+I({tenantId:t.tenantId,urlIdWS:n}),null,(function(){setTimeout(o,18e5)}),(function(){setTimeout(o,18e5)}))}),18e5)}function w(e,t,n,o,i,a){if(t.disableLiveCommenting)return;"boolean"==typeof a&&(o.usersOnlineMap[i]=a);const s=o.userIdsToCommentIds[i];if(s)for(const e of s){const a=document.getElementById(e);if(a){const e=a.querySelector(".activity-icon");e&&(e.outerHTML=N(t,n,o.usersOnlineMap[i]))}}}function N(e,t,n){return e.disableLiveCommenting?"":'<i class="activity-icon'+(n?" online":" offline")+'" title="'+(n?t.t151:t.t152)+'"></i>'}const k=new RegExp("<img ","g");function _(e,t,n,o,i,a,s,r,d,m,u,g,b,I,y,E,S,T,w){let L='<div class="comment'+(T.verified?"":" unverified")+(T.isLive?" is-live":"")+(T.isSpam?" is-spam":"")+(T.isUnapproved?" is-unapproved":"")+(e.readonly?" readonly":"")+(T.isBlocked?" is-blocked":"")+'" id="'+T._id+'">';return!T.hidden&&T.isLive&&delete T.isLive,L+=function(e,t,n,o,i,a,s,r,d,m,u,g,b,I,y,E,S,T,w){let L,C="";const O=o&&(T.userId===o.id||T.anonUserId===o.id),A=!T.isDeleted&&(o&&o.authorized&&(w||O)||T.editKey),M=w&&!T.parentId,D=!T.isDeleted&&!T.isByAdmin&&!T.isByModerator&&!O&&o&&o.authorized,R='<img class="pin" src="/images/pin.png" alt="'+t.t94+'" title="'+t.t94+'">',U=!T.isBlocked&&T.commenterLink,H=new Date(T.date),P=H.toLocaleString(),V='<a href="'+((T.url?T.url:e.url)||"")+"#fast-comments-jt="+T._id+'" class="jump-link" target="_blank" data-comment-id="'+T._id+'" title="'+P+'">'+x(e,t,H,P)+"</a>";C+='<div class="top-right">',T.isPinned&&(C+=R),e.readonly||(C+=h(t,n,T,A,M,D)),C+="</div>",T.verified||T.wasPostedCurrentSession&&T.requiresVerification||e.disableUnverifiedLabel||(C+='<div class="unverified-notice">'+t.t48+"</div>"),T.wasPostedCurrentSession&&(T.isSpam?(C+='<div class="spam-notice">'+t.t49+"</div>",L=!0):T.requiresVerification&&(C+='<div class="requires-verification-approval">'+t.t50+"</div>",L=!0)),L||!1!==T.approved||(C+='<div class="awaiting-approval-notice">'+t.t56+"</div>");let F="",B=T.commenterName;T.isDeleted?B=t.t78:T.isBlocked&&(B=t.t144);const G=N(e,t,!0===i.usersOnlineMap[T.userId]||!0===i.usersOnlineMap[T.anonUserId]);if(F='<div class="commenter-name"><b>'+(U?'<a href="'+T.commenterLink+'" class="website-url" rel="noreferrer noopener nofollow" target="_blank">':"")+B+(U?"</a>":"")+"</b> "+V,T.displayLabel?F+='<span class="label">'+T.displayLabel+"</span>":T.isByAdmin?F+='<span class="label">'+t.t88+"</span>":T.isByModerator&&(F+='<span class="label">'+t.t89+"</span>"),F+="</div>",!0!==e.hideAvatars){let n;n=T.avatarSrc&&!T.isBlocked?'<d class="avatar-wrapper"><img loading="lazy" width="40" height="40" src="'+T.avatarSrc+'" alt="'+t.t51+'" class="avatar comment-image" data-comment-id="'+T._id+'" />'+G+"</d>":'<d class="avatar-wrapper'+(e.defaultAvatarSrc?"":" anon")+'"><img loading="lazy" width="40" height="40" src="'+l(e)+'" alt="'+t.t52+'" class="avatar comment-image" data-comment-id="'+T._id+'" />'+G+"</d>",n+=F,o&&o.id===T.userId&&!o.isAnonSession?C+='<a href="https://fastcomments.com/auth/my-account/edit-avatar" target="_blank">'+n+"</a>":C+=n}else C+=F;C+='<div class="comment-content card" data-comment-id="'+T._id+'">',C+=F,C+='<div class="top-right">',T.isPinned&&(C+=R),e.readonly||(C+=h(t,n,T,A,M,D)),C+="</div>",T.hasImages&&(T.commentHTML=T.commentHTML.replace(k,"<img onload=\"window.fcHandleInlineImageLoaded('"+T._id+"', this)\" ")),n.forEach(e=>{e.commentTop&&(C+=e.commentTop(T))}),b[T._id]?(C+='<div class="comment-edit">',e.useSingleLineCommentInput?C+='<input class="comment-text comment-text-edit'+(T.isSavingEdit?" animated-background":"")+'" data-restore-id="edit-'+T._id+'" id="input-for-parent-'+T._id+'" '+(T.isSavingEdit?"disabled":"")+' data-parent-id="'+T._id+'" value="'+(T.textUpdateInProgress?T.textUpdateInProgress:T.comment)+'" />':C+='<textarea class="comment-text-edit'+(T.isSavingEdit?" animated-background":"")+'" data-restore-id="edit-'+T._id+'" id="input-for-parent-'+T._id+'" '+(T.isSavingEdit?"disabled":"")+' data-parent-id="'+T._id+'">'+(T.textUpdateInProgress?T.textUpdateInProgress:T.comment)+"</textarea>",C+="</div>",C+='<div class="edit-bottom">',C+="<div>"+c(e,t,0,T._id)+"</div>",C+='<div class="edit-actions"><button type="button" class="edit-cancel" data-comment-id="'+T._id+'">'+t.t43+'</button><button type="button" class="edit-save" data-comment-id="'+T._id+'">'+t.t72+"</button></div>",C+="</div>"):(C+='<div class="comment-text">',T.isDeleted?C+=t.t78:T.isBlocked?C+=t.t143:C+=T.commentHTML,C+="</div>"),T.editFailure&&(C+='<div class="fc-red edit-failure">'+(T.editFailureExpiration?t.t73:t.t74)+"</div>"),C+='<div class="comment-vote">'+v(e,t,u,g,S,y,T,s[T._id])+"</div>",C+='<div class="reply-form-wrapper">',s[T._id]&&(C+=p(e,t,n,o,0,r,s,d,m,I,y,E,T._id)),C+="</div>",n.forEach(e=>{e.commentBottom&&(C+=e.commentBottom(T))}),C+="</div>",T.errorMessage&&(C+='<div class="prompt comment-error">',C+="<p>",C+=T.errorMessage,C+="</p>",C+='<div class="comment-error-close">',C+='<button class="comment-error-close-btn" type="button" data-comment-id="'+T._id+'">'+t.t147+"</button>",C+="</div>",C+="</div>"),A&&T.promptDelete&&(C+='<div class="prompt">',C+="<p>"+t.t79+"</p>",C+="<div>",T.deleteFailure?T.deleteFailureExpiration?C+='<p class="fc-red">'+t.t81+"</p>":C+='<p class="fc-red">'+t.t82+"</p>":T.isSavingDelete?C+="<p>"+t.t80+"</p>":(C+='<button type="button" class="comment-cancel-delete" data-comment-id="'+T._id+'">'+t.t43+"</button>",C+='<button type="button" class="comment-do-delete" data-comment-id="'+T._id+'">'+t.t77+"</button>"),C+="</div>",C+="</div>"),n.forEach(e=>{e.commentInnerHTMLFilter&&(C=e.commentInnerHTMLFilter(T,C))});const q=g[T._id];let j="";if(T.hiddenChildrenCount&&!q&&(j+='<div data-comment-id="'+T._id+'" class="new-comments-message">'+f(t,T.hiddenChildrenCount)+"</div>"),C+=j,T.children&&!q){C+='<div class="children">';for(const c of T.children)!0!==c.hidden&&(C+=_(e,t,n,o,i,a,s,r,d,m,u,g,b,I,y,E,S,c,w));C+="</div>"}return n.forEach(e=>{e.commentFilter&&(C=e.commentFilter(T,C))}),C}(e,t,n,o,i,a,s,r,d,m,u,g,b,I,y,E,S,T,w),L+="</div>",L}function L(e,t,n,o,i){if(!o.parentId||n[o.parentId]){if(e.push(o),o.parentId)n[o.parentId].children?i?n[o.parentId].children.push(o):n[o.parentId].children.unshift(o):n[o.parentId].children=[o];else if(t.length>0&&t[0].isPinned){let e=!1;for(let n=0;n<t.length;n++)if(!t[n].isPinned){t.splice(n,0,o),e=!0;break}e||t.push(o)}else i?t.push(o):t.unshift(o);C(t,n,o.parentId,1)}}function C(e,t,n,o){for(;n;){const e=t[n];if(!e)break;void 0===e.nestedChildrenCount&&(e.nestedChildrenCount=0),e.nestedChildrenCount+=o,n=e.parentId}}function O(e,t,n,o,i){for(;i;){const t=n[i];if(!t)break;const a=document.getElementById(i);if(a){const n=a.querySelector(".toggle-replies");n&&(n.outerHTML=g(e,o,t))}i=t.parentId}}function A(e,t,n){let o="";return e.commentCountFormat?o+=e.commentCountFormat.replace("[count]",Number(n).toLocaleString()):o+=Number(n).toLocaleString()+(1===n?t.t33:t.t32),o}function M(e,t){return(e||"").replace("[count]",Number(t).toLocaleString())}var D=["onclick","ondblclick","onmousedown","onmouseup","onmouseover","onmousemove","onmouseout","onmouseenter","onmouseleave","ontouchcancel","ontouchend","ontouchmove","ontouchstart","ondragstart","ondrag","ondragenter","ondragleave","ondragover","ondrop","ondragend","onkeydown","onkeypress","onkeyup","onunload","onabort","onerror","onresize","onscroll","onselect","onchange","onsubmit","onreset","onfocus","onblur","oninput","onanimationend","onanimationiteration","onanimationstart","oncontextmenu","onfocusin","onfocusout"],R=D.length;function U(e,t){var n=e.nodeType,o=e.nodeName;1===n&&function(e,t){for(var n=t.attributes,o=e.attributes,i=null,a=null,s=null,r=null,d=o.length-1;d>=0;--d)r=o[d],s=r.name,i=r.namespaceURI,a=r.value,i?(s=r.localName||s,t.getAttributeNS(i,s)!==a&&t.setAttributeNS(i,s,a)):t.hasAttribute(s)?t.getAttribute(s)!==a&&("null"===a||"undefined"===a?t.removeAttribute(s):t.setAttribute(s,a)):t.setAttribute(s,a);for(var c=n.length-1;c>=0;--c)!1!==(r=n[c]).specified&&(s=r.name,(i=r.namespaceURI)?(s=r.localName||s,e.hasAttributeNS(i,s)||t.removeAttributeNS(i,s)):e.hasAttributeNS(null,s)||t.removeAttribute(s))}(e,t),3!==n&&8!==n||t.nodeValue!==e.nodeValue&&(t.nodeValue=e.nodeValue),"INPUT"===o?function(e,t){var n=e.value,o=t.value;H(e,t,"checked"),H(e,t,"disabled"),e.indeterminate!==t.indeterminate&&(t.indeterminate=e.indeterminate);if("file"===t.type)return;n!==o&&(t.setAttribute("value",n),t.value=n);"null"===n&&(t.value="",t.removeAttribute("value"));e.hasAttributeNS(null,"value")?"range"===t.type&&(t.value=n):t.removeAttribute("value")}(e,t):"OPTION"===o?function(e,t){H(e,t,"selected")}(e,t):"TEXTAREA"===o&&function(e,t){var n=e.value;n!==t.value&&(t.value=n);if(t.firstChild&&t.firstChild.nodeValue!==n){if(""===n&&t.firstChild.nodeValue===t.placeholder)return;t.firstChild.nodeValue=n}}(e,t),function(e,t){for(var n=0;n<R;n++){var o=D[n];e[o]?t[o]=e[o]:t[o]&&(t[o]=void 0)}}(e,t)}function H(e,t,n){e[n]!==t[n]&&(t[n]=e[n],e[n]?t.setAttribute(n,""):t.removeAttribute(n))}function P(e,t){if(!e)throw new Error(t||"AssertionError")}P.notEqual=function(e,t,n){P(e!=t,n)},P.notOk=function(e,t){P(!e,t)},P.equal=function(e,t,n){P(e==t,n)},P.ok=P;function V(e,t,n){return P.equal(typeof e,"object","nanomorph: oldTree should be an object"),P.equal(typeof t,"object","nanomorph: newTree should be an object"),n&&n.childrenOnly?(G(t,e),e):(P.notEqual(t.nodeType,11,"nanomorph: newTree should have one root node (which is not a DocumentFragment)"),F(t,e))}function F(e,t){return t?e?e.isSameNode&&e.isSameNode(t)?t:e.tagName!==t.tagName||B(e)!==B(t)?e:(U(e,t),G(e,t),t):null:e}function B(e){return e.dataset?e.dataset.nanomorphComponentId:void 0}function G(e,t){for(var n,o,i,a,s=0,r=0;n=t.childNodes[r],o=e.childNodes[r-s],n||o;r++)if(o)if(n)if(q(o,n))(i=F(o,n))!==n&&(t.replaceChild(i,n),s++);else{a=null;for(var d=r;d<t.childNodes.length;d++)if(q(t.childNodes[d],o)){a=t.childNodes[d];break}a?((i=F(o,a))!==a&&s++,t.insertBefore(i,n)):o.id||n.id?(t.insertBefore(o,n),s++):(i=F(o,n))!==n&&(t.replaceChild(i,n),s++)}else t.appendChild(o),s++;else t.removeChild(n),r--}function q(e,t){return e.id?e.id===t.id:e.isSameNode?e.isSameNode(t):e.tagName===t.tagName&&(3===e.type&&e.nodeValue===t.nodeValue)}function j(t,n,o,i,a,s,r,d,c,l,m){try{if(t.disableLiveCommenting)return;let g=!1;function u(e){if("new-comment"===e.type)return e.comment._id}function p(n,o,a){e(t,"GET","/event-log/"+t.tenantId+"/"+I({urlId:i,startTime:n,endTime:o}),null,(function(e){if(e&&e.events){function t(e,t){let n=!1;for(const o of e)m=Math.max(m,o.timestamp+1),t&&t[u(o)]||!d(o)||(n=!0);n&&c&&c(),a&&a()}const n=e.events.map((function(e){return JSON.parse(e.data)}));if(r){const e=[];for(const t of n){const n=u(t);n&&e.push(n)}e.length>0?r(e,(function(e){t(n,e)})):t(n)}else t(n)}else a&&a()}),(function(e){console.error("FastComments: fetchEventLog FAILURE",e),a?a():setTimeout((function(){p(n,Date.now())}),5e3*Math.random())}))}if(t.usePolling){function f(){g||setTimeout((function(){g||p(m,Date.now(),f)}),2e3)}return m||(m=Date.now()),f(),{close:function(){g=!0}}}{const e=new WebSocket((!1===t.isProd?"ws://localhost:8081":"wss://ws.fastcomments.com")+"/sub?urlId="+a+"&userIdWS="+s+"&tenantIdWS="+o);return e.onopen=function(){g||(m&&p(m,Date.now()),n.forEach((function(e){e.onLiveConnectionStatusUpdate&&e.onLiveConnectionStatusUpdate(!0)})),l&&l(!0,m))},e.onclose=function(){e.removeAllListeners&&e.removeAllListeners(),m||(m=Date.now()),n.forEach((function(e){e.onLiveConnectionStatusUpdate&&e.onLiveConnectionStatusUpdate(!1)})),g||(l&&l(!1,m),setTimeout((function(){j(t,n,o,i,a,s,r,d,c,l,m)}),2e3*Math.random()))},e.onmessage=function(e){if(g)return;const t=JSON.parse(decodeURIComponent(e.data));if(m=Math.max(m,t.timestamp),r){const e=u(t);e?r([e],(function(n){n[e]||d(t)&&c&&c()})):d(t)&&c&&c()}else d(t)&&c&&c()},{close:function(){g=!0,e&&e.close()}}}}catch(e){console.error(e)}}function z(e,t,n){return(t?e.t118:e.t117).replace("[count]",Number(n).toLocaleString())}function W(e,t){return e.substring(t-1,t)}function K(e){e.isTypingMention=!1,J(e)}function J(e){e.searchList&&e.searchList.remove(),e.keyboardSelectedNode=null,e.container&&e.container.classList.remove("search-list-open")}function Y(t,n,o){if(o.target&&(o.target.classList.contains("comment-input")||o.target.classList.contains("comment-text-edit")))if(n.isTypingMention)if(" "===W(o.target.value,o.target.selectionStart))K(n);else{if(27===o.keyCode)return void K(n);if("@"!==o.target.value.substr(n.mentionPosition-1,1))return void K(n);if(40===o.keyCode)return o.preventDefault(),o.stopPropagation(),void(n.keyboardSelectedNode?n.keyboardSelectedNode.nextSibling&&!n.keyboardSelectedNode.nextSibling.classList.contains("cross")&&(n.keyboardSelectedNode.classList.remove("kb-select"),n.keyboardSelectedNode=n.keyboardSelectedNode.nextSibling,n.keyboardSelectedNode.classList.add("kb-select")):(n.keyboardSelectedNode=n.searchList.children[0],n.keyboardSelectedNode.classList.add("kb-select")));if(38===o.keyCode&&n.keyboardSelectedNode)return o.preventDefault(),o.stopPropagation(),void(n.keyboardSelectedNode.previousSibling?(n.keyboardSelectedNode.classList.remove("kb-select"),n.keyboardSelectedNode=n.keyboardSelectedNode.previousSibling,n.keyboardSelectedNode.classList.add("kb-select")):K(n));if(13===o.keyCode&&n.keyboardSelectedNode)return o.preventDefault(),o.stopPropagation(),void n.keyboardSelectedNode.click();const i=o.target.value.substring(n.mentionPosition,o.target.selectionStart);n.requestId?n.requestId++:n.requestId=1;let a=n.requestId;e(t,"GET","/user-search/"+t.tenantId+"/"+I({urlId:t.urlId,sso:t.sso?JSON.stringify(t.sso):null,usernameStartsWith:i,mentionGroupIds:t.mentionGroupIds?t.mentionGroupIds.join(","):null}),null,(function(e){if(n.requestId===a)if("success"===e.status){if(!e.users.length)return void J(n);const i=o.target.parentNode;if(i){let a=i.querySelector(".search-list");a||(a=document.createElement("div"),a.classList.add("search-list"),a.addEventListener("click",(function(e){if(e.target)if(e.target.classList.contains("search-entry")){const t=o.target.selectionStart,i=o.target.selectionEnd,a=o.target.value.substring(t,o.target.value.length),s=e.target.attributes["data-id"].value,r=e.target.attributes["data-name"].value;o.target.value=o.target.value.substring(0,n.mentionPosition)+r+a,o.target.selectionEnd=t===i?n.mentionPosition+r.length:i+r.length,o.target.focus(),o.target.currentCommentMentions||(o.target.currentCommentMentions=[]),o.target.currentCommentMentions.push({id:s,tag:"@"+r,sent:!1}),K(n)}else e.target.classList.contains("cross")&&K(n)})),i.appendChild(a));let s="";for(let n=0;n<e.users.length;n++){const o=e.users[n];s+=`<div class="search-entry ${n===e.users.length-1?"last":""}" data-id="${o.id}" data-type="${o.type}" data-name="${o.name}">\n                                <img src="${o.avatarSrc?o.avatarSrc:l(t)}" alt="${o.name}" title="${o.name}" />\n                                <span>${o.name}</span>\n                            </div>`}s+='<i class="icon cross"></i>',a.innerHTML=s,n.searchList=a,n.container=i.parentNode,n.container.classList.add("search-list-open")}}else console.error("User search failure",e)}))}else o.target.value&&"@"===W(o.target.value,o.target.selectionStart)&&(n.isTypingMention=!0,n.mentionPosition=o.target.selectionStart)}function $(e,t){return e.substring(t-1,t)}function X(e){e.isTypingHashTag=!1,Q(e)}function Q(e){e.searchList&&e.searchList.remove(),e.keyboardSelectedNode=null,e.container&&e.container.classList.remove("search-list-open")}function Z(t,n,o){if(o.target&&(o.target.classList.contains("comment-input")||o.target.classList.contains("comment-text-edit")))if(n.isTypingHashTag)if(" "===$(o.target.value,o.target.selectionStart))X(n);else{if(27===o.keyCode)return void X(n);if("#"!==o.target.value.substr(n.mentionPosition-1,1))return void X(n);if(40===o.keyCode)return o.preventDefault(),o.stopPropagation(),void(n.keyboardSelectedNode?n.keyboardSelectedNode.nextSibling&&!n.keyboardSelectedNode.nextSibling.classList.contains("cross")&&(n.keyboardSelectedNode.classList.remove("kb-select"),n.keyboardSelectedNode=n.keyboardSelectedNode.nextSibling,n.keyboardSelectedNode.classList.add("kb-select")):(n.keyboardSelectedNode=n.searchList.children[0],n.keyboardSelectedNode.classList.add("kb-select")));if(38===o.keyCode&&n.keyboardSelectedNode)return o.preventDefault(),o.stopPropagation(),void(n.keyboardSelectedNode.previousSibling?(n.keyboardSelectedNode.classList.remove("kb-select"),n.keyboardSelectedNode=n.keyboardSelectedNode.previousSibling,n.keyboardSelectedNode.classList.add("kb-select")):X(n));if(13===o.keyCode&&n.keyboardSelectedNode)return o.preventDefault(),o.stopPropagation(),void n.keyboardSelectedNode.click();const i=o.target.value.substring(n.mentionPosition,o.target.selectionStart);n.requestId?n.requestId++:n.requestId=1;let a=n.requestId;i.length>1&&e(t,"GET","/hash-tag-search/"+t.tenantId+"/"+I({urlId:t.urlId,sso:t.sso?JSON.stringify(t.sso):null,startsWith:"#"+i}),null,(function(e){if(n.requestId===a)if("success"===e.status){if(!e.hashTags.length)return void Q(n);const t=o.target.parentNode;if(t){let i=t.querySelector(".search-list");i||(i=document.createElement("div"),i.classList.add("search-list"),i.addEventListener("click",(function(e){if(e.target)if(e.target.classList.contains("search-entry")){const t=o.target.selectionStart,i=o.target.selectionEnd,a=o.target.value.substring(o.target.selectionStart,o.target.value.length),s=e.target.attributes["data-tag"].value;o.target.value=o.target.value.substring(0,n.mentionPosition-1)+s+a,o.target.selectionEnd=t===i?n.mentionPosition-1+s.length:i+s.length,o.target.focus(),o.target.currentCommentHashTags||(o.target.currentCommentHashTags=[]),o.target.currentCommentHashTags.push({tag:s}),X(n)}else e.target.classList.contains("cross")&&X(n)})),t.appendChild(i));let a="";for(let t=0;t<e.hashTags.length;t++){const n=e.hashTags[t];a+=`<div class="search-entry ${t===e.hashTags.length-1?"last":""}" data-tag="${n.tag}">\n                                <span>${n.tag}</span>\n                            </div>`}a+='<i class="icon cross"></i>',i.innerHTML=a,n.searchList=i,n.container=t.parentNode,n.container.classList.add("search-list-open")}}else console.error(e)}))}else o.target.value&&"#"===$(o.target.value,o.target.selectionStart)&&(n.isTypingHashTag=!0,n.mentionPosition=o.target.selectionStart)}function ee(e,n,o){const i=document.getElementById(n);i&&setTimeout((function(){!function(e,n){t(JSON.stringify({type:"scroll-to-position",instanceId:e,y:n}),"*")}(e,i.getBoundingClientRect().top)}),o)}const te=function(e){return document.getElementById(e)},ne=function(e,t){return e.target.attributes.getNamedItem(t)},oe=function(e,t){return e.getAttribute(t)};function ie(l,u,g){let h,b,T,N,k,D,R,U,H,P,F,B,G,q,W,K,J,$=u.url?u.url:window.location.href,X=u.urlId?u.urlId:window.location.href,Q={},ie={},ae={},se={},re={},de={},ce={},le=[],me=u.simpleSSO?u.simpleSSO:void 0,ue=0,pe="number"==typeof u.startingPage?u.startingPage:0,fe=[],ge=[],ve=[],he={ERROR_MESSAGE:"Whoops! Something went wrong. Please try again later."},be=!0,xe=u.sso?JSON.stringify(u.sso):null,Ie=u.defaultSortDirection,ye={},Ee=!1;if(u.sso&&"object"!=typeof u.sso)throw new Error("Invalid SSO Configuration!");const Se=u.urlId.includes("googleusercontent.com"),Te=u.tenantId;u.hasDarkBackground&&l.classList.add("dark"),l.classList.add("v1"),FastCommentsUI.makeRequest=e,FastCommentsUI.createURLQueryString=I,FastCommentsUI.redirect=n;const we={usersOnlineMap:{},userIdsToCommentIds:{}},Ne={},ke=[];let _e=0;function Le(e){_e++,e||_e!==ke.length||Ae()}function Ce(e,t,n,o){const i=document.createElement("script");i.setAttribute("src",t),i.onload=function(){let t,i;ke.forEach((function(n){n.id===e&&(n.config=u,n.translations=he,n.commentsById=h,n.reRenderComment=Be,n.removeCommentAndReRender=We,n.newBroadcastId=Ke,n.root=l,n.setupEventHandlers&&n.setupEventHandlers(l,Q),n.notificationState=Ne,t=n.init,i=n)})),t?t((function(){Le(n),o&&o(i)})):(Le(n),o&&o(i))},document.body.appendChild(i),ke.push({id:e,scriptNode:i})}function Oe(e){return"all"===Te&&u.userId&&e?e.tenantId:Te}function Ae(){for(const e of ke)e.resetAndReRender=Xe;const m=setInterval(Pe,1e3);function p(t,n,o,i,s){const r=h[t];if(!me&&!u.allowAnonVotes)if(u.allowAnon){if(!o)return r.pendingAuthVotingDir=n,void Ge(r)}else if(!o||!i)return r.pendingAuthVotingDir=n,void Ge(r);r.didVoteThisSession=!0,r.voteInProgress=!0,delete re[t],Ge(r);const d=Ke(),c=Oe(h[t]);e(u,"POST","/comments/"+c+"/"+t+"/vote"+I({urlId:X,sso:xe,broadcastId:d,sessionId:me?me.sessionId:void 0}),{voteDir:n,commentId:t,urlId:X,url:$,commenterName:me?me.username:o,commenterEmail:me?me.email:i},(function(e){delete r.voteInProgress,"success"===e.status?("up"===n?(r.isVotedUp=!0,r.votes++,r.votesUp=(r.votesUp||0)+1):(r.isVotedDown=!0,r.votes--,r.votesDown=(r.votesDown||0)+1),r.myVoteId=e.voteId,a(u.instanceId,r,e.voteId,n,e.status),e.editKey?r.voteEditKey=e.editKey:delete r.voteEditKey,delete r.pendingAuthVotingDir,delete r.voteUsernameTaken,Ge(r),s&&s(e)):"pending-verification"===e.status?("up"===n?r.isVotedUp=!0:r.isVotedDown=!0,e.isVerified||(r.pendingVote=!0),r.myVoteId=e.voteId,a(u.instanceId,r,e.voteId,n,e.status),r.voteEditKey=e.editKey,delete r.pendingAuthVotingDir,delete r.voteUsernameTaken,Ge(r),s&&s(e)):"failed"===e.status?("already-voted"===e.code?(r.errorAlreadyVoted=!0,delete r.pendingAuthVotingDir,delete r.voteUsernameTaken):"username-taken"===e.code?r.voteUsernameTaken=!0:"banned"===e.code&&(re[t]=e),Ge(r)):re[t]=!0}),(function(){re[t]=!0}))}function g(t){const n=t._id;t.didVoteThisSession=!1,t.voteInProgress=!0,delete re[n],Ge(t);const o=Ke(),i=Oe(h[n]);e(u,"DELETE","/comments/"+i+"/"+n+"/vote/"+t.myVoteId+I({voteId:t.myVoteId,editKey:t.voteEditKey,commentId:n,sso:xe,broadcastId:o,urlId:X}),null,(function(e){delete t.voteInProgress,"success"===e.status?(a(u.instanceId,t,t.myVoteId,"deleted",e.status),t.isVotedUp?(delete t.isVotedUp,e.wasPendingVote||(t.votes--,t.votesUp--)):(delete t.isVotedDown,e.wasPendingVote||(t.votes++,t.votesDown--)),Ge(t)):"failed"===e.status?("banned"===e.code&&(re[n]=e),Ge(t)):re[n]=!0}),(function(){re[n]=!0}))}function v(e,t,n){return function(o){if(o.target){const e=o.target.querySelector("textarea");e&&e.focus()}const i=ne(o,"data-parent-id");if(!i)return;const a=i.value;n&&n(a);const s=l.querySelector("."+t+"["+e+'="'+a+'"]');s&&s.classList.add("show-default-hidden"),Ve()}}function _(t,n){const o=ne(t,"data-comment-id").value,i=Oe(h[o]);e(u,"GET","/comments/"+i+"/"+o+"/text"+I({sso:xe,editKey:h[o].editKey}),null,(function(e){"success"===e.status?(se[o]=n,h[o].comment=e.commentText,delete h[o].editFailure,delete h[o].editFailureExpiration,Be(h[o]),setTimeout((function(){const e=te("input-for-parent-"+o);e&&e.scrollHeight>0&&(e.style.height=e.scrollHeight+10+"px")}),10)):(h[o].errorMessage=he.t67,Be(h[o]))}),(function(){h[o].errorMessage=he.t67,Be(h[o])}))}function C(t,n){const o=ne(t,"data-comment-id").value,i=[];for(const e in h)i.push(e);n&&me&&(me.hasBlockedUsers=!0);const a=Oe(h[o]);e(u,n?"POST":"DELETE","/block-from-comment/"+o+"/"+I({tenantId:a,urlId:X,sso:xe}),{commentIds:i},(function(e){if("success"===e.status){h[o].isBlocked=n,Be(h[o]);for(const t in e.commentStatuses)if(h[t]){const n=!!h[t].isBlocked,o=e.commentStatuses[t];n!==o&&(h[t].isBlocked=o)}Me()}else e.translatedError&&(h[o].errorMessage=e.translatedError,Be(h[o]))}),(function(e){e.translatedError?(h[o].errorMessage=e.translatedError,Be(h[o])):(h[o].errorMessage=he.t67,Be(h[o]))}))}function A(e,t){const n=Ie||"MR",o=t[n].before,i=t[n].after;let a,s;for(let t=0;t<b.length;t++)if(b[t]._id===e){a=t;break}b.splice(a,1);for(let e=0;e<b.length;e++){if(b[e]._id===o){s=e+1;break}if(b[e]._id===i){s=e-1;break}}b.splice(s,0,h[e]);const r=document.getElementById(e);if(o){const e=document.getElementById(o);e&&e.parentNode.insertBefore(r,e.nextSibling)}else if(i){const e=document.getElementById(i);e&&e.parentNode.insertBefore(r,e)}}function M(e,t){const n=ne(e,"data-comment-id").value;h[n].promptDelete=t,Be(h[n])}function V(e){if(e.target.form){const t=e.target.form.querySelector('button[type="submit"]');t&&t.click()}}window.fcHandleInlineImageLoaded=function(e,t){let n=h[e]._imageSizes;n||(n={}),n[t.src]={w:t.width,h:t.height},h[e]._imageSizes=n,setTimeout(Pe,300)},Q["comment-reply-start"]=function(e){const t=ne(e,"data-comment-id").value;ce[t]=!0,je(t)},Q["fast-comments-reply"]=function(n){if(u.readonly)return;let o=ne(n,"data-parent-id").value;if("null"===o&&(o=null),Ee&&null===o){n.preventDefault(),Ee=!1,Fe(Me);return void te("input-for-parent-"+o).focus()}let i=!1;const a=te("username-input-for-parent-"+o),s=a?a.value:null,d=te("email-input-for-parent-"+o),c=d?d.value:null,m=te("input-for-parent-"+o),p=m.value,f=u.allowAnon,g=te("link-input-for-parent-"+o),v=g?g.value:null;if(a&&!f&&d&&(!s||!f&&!c)||!p)return;if(!f&&d&&d.validity.typeMismatch)return;n.preventDefault();const x=me?me.id:null;!me&&s&&(i=!0);const y=Oe(o?h[o]:null),S=function(e){return"all"===Te&&u.userId&&e&&e.url?e.url:$}(o?h[o]:null),w={tenantId:y,urlId:function(e){return"all"===Te&&u.userId&&e&&e.urlId?e.urlId:X}(o?h[o]:null),url:S,pageTitle:function(e){return"all"===Te&&u.userId&&e&&"string"==typeof e.pageTitle?e.pageTitle:u.pageTitle}(o?h[o]:null),commenterName:me?me.username:s,commenterEmail:me?me.email:c,commenterLink:me?me.websiteUrl:v,avatarSrc:me&&u.simpleSSO?me.avatarSrc||me.avatar:void 0,comment:p,parentId:o,date:Date.now(),productId:u.productId,meta:u.commentMeta,mentions:m.currentCommentMentions,hashTags:m.currentCommentHashTags};ke.forEach(e=>{e.prepareCommentForSaving&&e.prepareCommentForSaving(w,o)}),ie[o]=!0,Fe(null===o?Me:function(){Be(h[o])});const N=Ke();e(u,"POST","/comments/"+y+"/"+I({urlId:X,sso:xe,broadcastId:N,sessionId:me?me.sessionId:void 0}),w,(function(e){delete ie[o];let n=!1;if(e.customConfig&&De(e.customConfig),"success"===e.status){if(function(e,n){t(JSON.stringify({type:"reply-success",instanceId:e,comment:n}),"*")}(u.instanceId,e.comment),e.comment.wasPostedCurrentSession=!0,T++,h[e.comment._id]=e.comment,o&&(delete ce[o],ye[o]=!1),L(le,b,h,e.comment,u.newCommentsToBottom),O(he,0,h,ye,e.comment.parentId),e.user){if(u.simpleSSO)for(const t in e.user)me[t]=e.user[t];else me=e.user;r(u.instanceId,"user-set",me)}delete ae[o],me&&e.user&&e.user.sessionId&&(me.sessionId=e.user.sessionId,r(u.instanceId,"session-id-set",me)),n=!0}else{if(i&&(me=null,r(u.instanceId,"authentication-failed",w)),e.translations)for(const t in e.translations)u.translations[t]=e.translations[t];ae[o]=e}Re(o);const a=me?me.id:null;if(a!==x||e.userIdWS!==He?$e(Je,Ue,e.userIdWS):E(l,u,he,Je,we,b),Fe(null===o||a!==x?Me:function(){Be(h[o])}),n){const e=l.querySelector('[data-restore-id="fcc-null"]');e&&(e.value="")}ke.forEach(t=>{t.newComment&&t.newComment(e.comment)})}),(function(e){e.customConfig&&De(e.customConfig),delete ie[o],i&&(me=null,r(u.instanceId,"authentication-failed",w)),e&&e.code?ae[o]=e.code:ae[o]=!0,Fe(Me)}))},Q["fast-comments-reply-cancel"]=function(e){const t=ne(e,"data-parent-id").value;delete ae[t],"null"!==t&&delete ce[t],delete ie[t],je(t)},Q.upvote=function(e){if(u.readonly)return;const t=ne(e,"data-comment-id").value,n=h[t];n.isVotedUp||n.isVotedDown?g(n):p(t,"up")},Q.downvote=function(e){if(u.readonly)return;const t=ne(e,"data-comment-id").value,n=h[t];n.isVotedUp||n.isVotedDown?g(n):p(t,"down")},Q["vote-auth-cancel"]=function(e){const t=ne(e,"data-comment-id").value;delete h[t].pendingAuthVotingDir,Be(h[t])},Q["vote-auth-submit"]=function(e){const t=ne(e,"data-comment-id").value,n=h[t],o=te("username-vote-input-for-comment-"+t),i=o?o.value:null,a=te("email-vote-input-for-comment-"+t),s=a?a.value:null;if(!me)if(u.allowAnon){if(!i)return}else if(!i||!s)return;a&&s&&a.validity.typeMismatch||(e.preventDefault(),p(t,n.pendingAuthVotingDir,i,s,(function(e){!me&&i&&s&&(me={username:i,email:s},r(u.instanceId,"user-set",me),e.user&&e.user.sessionId&&(me.sessionId=e.user.sessionId,r(u.instanceId,"session-id-set",me)))})))},Q["t-create-account"]=function(e){n(u.instanceId,e.target.href)},Q["t-upgrade"]=function(e){n(u.instanceId,e.target.href)},Q["t-configure-domains"]=function(e){n(u.instanceId,e.target.href)},Q["log-out"]=function(o){if(u.sso){if(u.sso.logoutURL)return n(u.instanceId,u.sso.logoutURL);u.sso.logoutCallback&&(u.sso.logoutCallback instanceof Function?u.sso.logoutCallback(u.instanceId):(i=u.instanceId,t(JSON.stringify({type:"logout",instanceId:i}),"*")))}var i;const a=ne(o,"data-parent-id").value;delete de[a],e(u,"PUT","/auth/logout",null,(function(){let e=me?me.id:null;me=null,$e(Je,Ue,null),r(u.instanceId,"logout",me);for(const e in Ne)delete Ne[e];delete we.usersOnlineMap[e],delete we.userIdsToCommentIds[e],E(l,u,he,Je,we,b),Fe(Me)}),(function(){de[a]=!0,Fe(Me)}))},Q["sso-login"]=function(){var e;u.sso.loginURL?n(u.instanceId,u.sso.loginURL):u.sso.loginCallback instanceof Function?u.sso.loginCallback(u.instanceId):(e=u.instanceId,t(JSON.stringify({type:"login",instanceId:e}),"*"))},Q["comments-toggle"]=function(){D=!D,Me()},window.fcHandleCommentInputSelected=v("data-parent-id","comment-reply",(function(e){ce[e]=!0})),Q["comment-input"]=window.fcHandleCommentInputSelected,Q["comment-text-edit"]=v("data-comment-id","comment-content"),Q["new-comments-message"]=function(e){const t=ne(e,"data-comment-id").value;if("null"===t){let e=30;y(b,(function(t){if(t.hidden)return e--,ue--,delete t.hidden,e>0})),ue=Math.max(ue,0),Fe(Me)}else{let e;if(y(b,(function(n){if(n._id===t)return e=n,!1})),e){if(e.children){let t=30;y(e.children,(function(n){return n.hidden&&(delete n.hidden,e.hiddenChildrenCount--,t--),t>0}))}delete e.hidden,e.hiddenChildrenCount<=0&&delete e.hiddenChildrenCount,Fe((function(){Be(e)}))}else console.warn("FastComments - ERR 0",t)}},Q["load-prev-page"]=function(){l.classList.add("loading"),pe--,Qe((function(){l.classList.remove("loading")}),!0)},Q["load-next-page"]=function(){l.classList.add("loading"),pe++,Qe((function(){l.classList.remove("loading")}))},Q["load-all"]=function(){l.classList.add("loading"),pe=-1,Qe((function(){l.classList.remove("loading")}))},Q["toggle-replies"]=function(e){const t=ne(e,"data-comment-id").value;ye[t]=!ye[t],Fe(Me)},Q["comment-error-close-btn"]=function(e){const t=ne(e,"data-comment-id").value;delete h[t].errorMessage,e.target.parentNode.parentNode.remove()},Q["t-btn"]=function(e){const t=ne(e,"data-action").value,n=oe(e.target.parentNode,"data-comment-id").valueOf(),o=te("input-for-parent-"+n);if("gif"===t){const e=ke.find((function(e){return"gifs"===e.id}));function i(e){e.toggleOpen(n,(function(e){const t=(o=n&&"null"!==n?n:null,Fe((function(){const e=l.querySelector('.toolbar[data-comment-id="'+o+'"]');e&&(e.outerHTML=c(u,he,0,o)),Ve()})),s(u.instanceId),l.querySelector('.toolbar[data-comment-id="'+o+'"]'));var o;e&&e(t)}))}return void(e?i(e):Ce("gifs","/js/comment-ui/extensions/comment-ui.gifs.extension.min.js",!0,(function(e){Fe(Me),i(e)})))}const a={bold:"b",ul:"u",it:"i",s:"strike",code:"code"},r=o.selectionStart,d=o.selectionEnd;let m,p;const f=o.value,g=f.substring(r,d);"link"===t?(m="["+(g?"":he.t91),p="]("+(g&&g.startsWith("http")?g:"https://example.com")+")"):(m=`<${a[t]}>`,p=`</${a[t]}>`),o.value=f.substring(0,r)+m+g+p+f.substring(d),o.selectionEnd=r===d?r+m.length:d+m.length+p.length,o.focus()},Q["menu-edit-comment"]=function(e){_(e,!0)},Q["notification-bell"]=function(){const e=ke.find((function(e){return"notifications-list"===e.id}));function t(e){e.toggleOpen(qe)}e?t(e):Ce("notifications-list","/js/comment-ui/extensions/comment-ui.notifications-list.extension.min.js",!0,(function(e){Fe(Me),t(e)}))},Q["menu-block-user"]=function(e){C(e,!0)},Q["menu-unblock-user"]=function(e){C(e,!1)},Q["menu-pin-comment"]=function(t){const n=ne(t,"data-comment-id").value,o=h[n],i=Ke(),a=!o.isPinned,s=Oe(h[n]);e(u,"POST","/comments/"+s+"/"+n+"/"+(a?"pin":"unpin")+I({urlId:X,sso:xe,broadcastId:i}),null,(function(e){"success"===e.status&&(o.isPinned=a,Be(o),A(n,e.commentPositions))}))},Q["menu-delete-comment"]=function(e){M(e,!0)},Q["comment-cancel-delete"]=function(e){M(e,!1)},Q["comment-do-delete"]=function(t){const n=ne(t,"data-comment-id").value,o=h[n];o.isSavingDelete=!0,Be(o);const i=Ke(),a=Oe(h[n]);e(u,"DELETE","/comments/"+a+"/"+n+"/"+I({urlId:X,editKey:o.editKey,sso:xe,broadcastId:i}),null,(function(e){delete o.isSavingDelete,"success"===e.status?e.hardRemoved?We(o):(o.isDeleted=e.comment.isDeleted,o.comment=e.comment.comment,o.commentHTML=e.comment.commentHTML,o.commenterName=e.comment.commenterName,o.commenterEmail=e.comment.commenterEmail,o.userId=e.comment.userId,Be(o)):(o.deleteFailure=!0,"edit-key-invalid"===e.code&&(o.deleteFailureExpiration=!0),Be(o))}),(function(){delete o.isSavingDelete,o.deleteFailure=!0,Be(o)}))},Q["edit-cancel"]=function(e){_(e,!1)},Q["edit-save"]=function(t){const n=ne(t,"data-comment-id").value,o=h[n],i=document.getElementById("input-for-parent-"+n),a=i.value;o.textUpdateInProgress=a,o.comment=a,o.isSavingEdit=!0,Be(o);const s=Ke(),r=Oe(h[n]);e(u,"POST","/comments/"+r+"/"+n+"/update-text/"+I({urlId:X,editKey:o.editKey,sso:xe,broadcastId:s}),{comment:a,mentions:i.currentCommentMentions,hashTags:i.currentCommentHashTags},(function(e){delete o.isSavingEdit,"success"===e.status?(delete o.textUpdateInProgress,delete o.editFailure,o.comment=e.comment.comment,o.commentHTML=e.comment.commentHTML,_(t,!1)):(o.editFailure=!0,"edit-key-invalid"===e.code&&(o.editFailureExpiration=!0),Be(o))}),(function(){delete o.isSavingEdit,o.editFailure=!0,Be(o)}))},Q["dir-drop-btn"]=function(e){const t=ne(e,"data-value").value;Ie!=t&&(Ie=t,Qe())},Q["comment-image"]=function(e){var n,o;u.disableImageRedirect&&(e.preventDefault(),e.stopPropagation()),n=u.instanceId,o=e.target.src,t(JSON.stringify({type:"on-image-clicked",instanceId:n,src:o}),"*")},Q["hash-tag"]=function(e){if(e.target.href.length>1){e.preventDefault(),e.stopPropagation();const t=ne(e,"data-tag").value,n=ke.find((function(e){return"filter-by-hash-tag"===e.id}));n?(n.addHashTagFilter(t),Xe()):Ce("filter-by-hash-tag","/js/comment-ui/extensions/comment-ui.filter-by-hash-tag.extension.min.js",!0,(function(e){e.resetAndReRender=Xe,e.addHashTagFilter(t),Xe()}))}},l.addEventListener("change",(function(e){if(!e.target.classList.contains("file-input"))return;const t=e.target.files[0],n=new FormData;n.append("file",t);const o=new XMLHttpRequest;o.withCredentials=!0;const i=(u.apiHost?u.apiHost:"https://fastcomments.com")+"/upload-image/"+Te;o.open("POST",i),o.setRequestHeader("Original-Referrer",u.originalReferrer),o.send(n),o.onload=function(){if(200===o.status){te("input-for-parent-"+oe(e.target,"data-parent-id").valueOf()).value+="[img]"+JSON.parse(o.response).url+"[/img]"}e.target.value=""}})),l.addEventListener("paste",(function(e){const t=e.target;if("textarea"!==t.tagName.toLowerCase()||!e.clipboardData)return;let n=e.clipboardData.getData("text/plain");if(n&&!n.includes("<code>")&&(n.includes("{")||n.includes("(")&&n.includes("\n  ")||n.includes("<")&&n.includes(">"))){n=n.replace(/\r/g,"");const o=n;if(0!==n.indexOf("    ")){const e=n.split("\n");for(let t=0;t<e.length;t++)e[t].startsWith("  ")?e[t]="  "+e[t]:e[t]="    "+e[t];n=e.join("\n")}setTimeout((function(){const i=t.value;e.target.value=i.replace(o,"<code>"+n+"</code>")}),0)}}));const _e={},Le={};function Ae(e){return 40===e.keyCode||38===e.keyCode||13===e.keyCode}function De(e){const t=u.translations;if(e){for(const t in e)void 0!==u[t]&&"translations"!==t||(u[t]=e[t]);!Ie&&u.defaultSortDirection&&(Ie=u.defaultSortDirection)}if(t)for(const e in t)u.translations[e]=t[e];u.translations&&(he=u.translations,ke.forEach((function(e){e.translations=he})))}let Ue,He,Je,Ye;function $e(t,n,o){(Je!==t||Ue!==n||He!==o)&&(Je=t,Ue=n,He=o,Ye&&Ye.close(),Ye=j(u,ke,Ue,X,Je,He,et,Ze,(function(){Fe(Me)}),(function(n,o){if(me&&w(0,u,he,we,me.id,n),n){if(!!o&&(we.userIdsToCommentIds={},we.usersOnlineMap={},me&&e(u,"GET","/user-notifications/get-count"+I({tenantId:Te,sso:xe}),null,(function(e){"success"===e.status&&(Ne.count=e.count,qe())}))),void 0!==window.IntersectionObserver){let e=!1;const n=new IntersectionObserver(o=>{if(o[0].isIntersecting&&!e){try{E(l,u,he,t,we,b)}catch(e){console.error(e)}e=!0,n.disconnect()}});n.observe(l)}else try{E(l,u,he,t,we,b)}catch(e){console.error(e)}}})))}function Xe(){pe=0,U=void 0,be=!0,Ee=!1,h={},le=[],b=[],Je=null,Ue=null,He=null,Ye&&Ye.close(),Qe()}function Qe(n,a){var s;s=u.instanceId,t(JSON.stringify({type:"on-init",instanceId:s}),"*");const c={urlId:X,page:pe,lastGenDate:U};0===ge.length&&(c.includei10n="true",u.locale&&(c.locale=u.locale)),u.countAll&&(c.countAll="true"),be&&(c.includeConfig="true",c.includeNotificationCount="true"),xe&&(c.sso=xe),c.direction=Ie,ke.length>0&&(c.modules=ke.map(e=>e.id).join(",")),u.jumpToId&&(c.fetchPageForCommentId=u.jumpToId),u.isCrawler&&(c.isCrawler=!0);let p={url:"all"===Te&&u.userId?"/comments-for-user":"/comments/"+Te+"/",params:c};for(const e of ke)e.mutateCommentFetchRequest&&(p=e.mutateCommentFetchRequest(p));e(u,"GET",p.url+I(p.params),void 0,(function(e){const t=Date.now(),s="rate-limited"===e.code;De(e.customConfig),s?J=he.t31:"domain-unauthorized"===e.code?J=he.t86:"unauthorized-page"===e.code?J=he.t153:"invalid-tenant"===e.code?J=he.t111:"malformed-sso"===e.code?(J=he.t87,e.reason&&"SSO Request Malformed"!==e.reason&&(J+=" "+e.reason)):Se?J=he.t146:e.isCommentsHidden&&(J=he.t28),!1===e.isProd&&(u.isProd=!1),"number"==typeof e.pageNumber&&(pe=e.pageNumber,fe.includes(pe)||fe.push(pe)),"number"==typeof e.notificationCount&&(Ne.count=e.notificationCount);const c=e.comments||[];if(P=c.length>=30,le=e.includesPastPages?c:a?c.concat(ge):pe>0?ge.concat(c):c,ge=JSON.parse(JSON.stringify(le)),T=le.length,e.moduleData&&(W=e.moduleData),e.isWhiteLabeled&&(K=!0),be&&u.readonly&&0===T)return clearInterval(m),o(u.instanceId,0),i(u.instanceId,u),void d(u.instanceId,[]);e.user&&!u.simpleSSO&&(me=e.user,r(u.instanceId,"user-set",me)),void 0===D&&(D=!(u.hideCommentsUnderCountTextFormat||u.useShowCommentsToggle));const p=function(e,t,n){const o={},i=n.length,a=[];let s,r;for(r=0;r<i;r++){const e=n[r];o[e._id]=e}for(r=0;r<i;r++){s=n[r],s.nestedChildrenCount=0,
//!commentsById[comment.parentId] check for user profile feed
!e||s.parentId&&o[s.parentId]||void 0!==t[s._id]||(t[s._id]=!0);const i=s.parentId;i&&o[i]?o[i].children?o[i].children.push(s):o[i].children=[s]:a.push(s)}for(r=0;r<i;r++){s=n[r];let e=s.parentId;for(;e&&(s=o[e],s);)s.nestedChildrenCount++,e=s.parentId}return{comments:a,commentsById:o}}(u.collapseReplies,ye,le);function f(){Fe(Me),u.debugRenderTime&&console.log("FastComments render time",Date.now()-t,"ms"),u.jumpToId&&(ee(u.instanceId,u.jumpToId,200),delete u.jumpToId,"number"==typeof e.pageNumber&&(pe=e.pageNumber)),i(u.instanceId,u),!s&&be&&null!==e.urlIdWS&&e.tenantIdWS&&e.userIdWS&&$e(e.urlIdWS,e.tenantIdWS,e.userIdWS),be&&ke.forEach((function(e){e.onInitialRenderComplete&&e.onInitialRenderComplete()})),be=!1,F||(!function(e,t,n,o){setTimeout((function i(){e.querySelectorAll(".comment").forEach((function(e){const i=e.id,a=o[i];if(a){const o=e.querySelectorAll(".jump-link"),i=new Date(a.date),s=i.toLocaleString();o.forEach((function(e){e.innerHTML=x(t,n,i,s)}))}})),setTimeout(i,6e4)}),6e4)}(l,u,he,h),F=!0),d(u.instanceId,e.comments),n&&n()}h=p.commentsById,b=p.comments,u.jumpToId&&function(e,t,n){let o=n,i=0;for(;o&&i<100&&(i++,delete e[o],t[o]);)o=t[o].parentId}(ye,h,u.jumpToId),B='<span class="fast-comments-waiting">'+he.t65+"</span>",G='<span class="fast-comments-waiting">'+he.t66+"</span>",q='<span class="fc-red">'+he.t67+"</span>",N=e.isSiteAdmin,k=e.hasBillingIssue,U=e.lastGenDate,R=e.isDemo,Number.isFinite(e.commentCount)&&(H=e.commentCount);let g=[];be&&(N&&g.push(["moderation","/js/comment-ui/extensions/comment-ui.moderation.extension.min.js"]),u.useSingleLineCommentInput&&g.push(["single-line-comment-input","/js/comment-ui/extensions/comment-ui.single-line-comment-input.extension.min.js"]));let v=g.length;function I(){v--,0===v&&f()}if(g.length>0)for(const e of g)Ce(e[0],e[1],!0,I);else f()}),(function(){n&&n()}))}function Ze(e){if(ve.includes(e.broadcastId))return!1;let t=!1;switch(e.type){case"notification":Ne.count?Ne.count++:Ne.count=1,Ne.notifications&&Ne.notifications.unshift(e.notification),qe();break;case"presence-update":if(ke.forEach((function(t){t.onPresenceUpdate&&t.onPresenceUpdate(e)})),e.changes)for(const t of e.changes)w(0,u,he,we,t.userId,"subscribe"===t.change);break;case"new-vote":const n=h[e.vote.commentId];n&&(null!==n.votes&&void 0!==n.votes||(n.votes=0),n.votes+=e.vote.direction,e.vote.direction>0?(null!==n.votesUp&&void 0!==n.votesUp||(n.votesUp=0),n.votesUp++,me&&me.id&&e.vote.userId===me.id&&(n.isVotedUp=!0)):(null!==n.votesDown&&void 0!==n.votesDown||(n.votesDown=0),n.votesDown++,me&&me.id&&e.vote.userId===me.id&&(n.isVotedDown=!0)),Ge(n));break;case"deleted-vote":const o=h[e.vote.commentId];o&&(o.votes+=-1*e.vote.direction,e.vote.direction>0?(o.votesUp&&o.votesUp--,me&&me.id&&o.isVotedUp&&e.vote.userId===me.id&&delete o.isVotedUp):(o.votesDown&&o.votesDown--,me&&me.id&&o.isVotedDown&&e.vote.userId===me.id&&delete o.isVotedDown),Ge(o));break;case"deleted-comment":h[e.comment._id]&&(ze(h[e.comment._id]),t=!0);break;case"new-comment":case"updated-comment":const i=e.comment,a=e.extraInfo,s=u.showLiveRightAway;if("new-comment"===e.type&&h[i._id]){if(h[i._id].approved||!i.approved)return;e.type="updated-comment"}const r=!h[i._id];if(r)h[i._id]=i;else for(const e in i)h[i._id][e]=i[e];if(r){S(we,i),i.isLive=!0;const e=D&&!s;i.hidden=e;let n=!1,o=null;i.parentId?o=h[i.parentId]:n=!0,L(le,b,h,i,u.newCommentsToBottom),O(he,0,h,ye,i.parentId),Re(i.parentId);const a=document.querySelector(".comments-toggle");if(a&&(a.classList.contains("comments-hidden-title")?a.innerHTML=u.hideCommentsUnderCountTextFormat.replace("[count]",H):a.innerHTML=z(he,D,H)),n)if(e){ue++;const e=te("new-comments-message-root");e&&(e.classList.remove("hidden"),e.innerHTML=f(he,ue))}else t=!0;else o&&(e&&(o.hiddenChildrenCount?o.hiddenChildrenCount++:o.hiddenChildrenCount=1),Fe((function(){Be(o)})));ke.length>0&&ke.forEach(e=>{e.newComment&&e.newComment(i)})}else Be(h[i._id],(function(){a&&a.commentPositions&&A(i._id,a.commentPositions)}))}return t}function et(t,n){function o(){const e={};for(const n of t)e[n]=!1;n(e)}me&&me.hasBlockedUsers?e(u,"GET","/check-blocked-comments"+I({commentIds:t.join(","),tenantId:Te,sso:xe}),null,(function(e){n(e.commentStatuses)}),(function(){o()})):o()}l.addEventListener("keyup",(function(e){(e.metaKey||e.ctrlKey)&&13===e.keyCode?V(e):Ae(e)||(Y(u,_e,e),Z(u,Le,e))})),l.addEventListener("keydown",(function(e){Ae(e)&&(Y(u,_e,e),Z(u,Le,e))})),l.addEventListener("click",(function(e){e.target.className&&e.target.className.split(" ").forEach((function(t){const n=Q[t];n&&n(e)}))})),l.addEventListener("submit",(function(e){e.preventDefault(),e.stopPropagation(),V(e)})),Qe()}function Me(){const e=function(e,t,n,o,i,a,s,r,d,c,l,u,g,v,h,b,x,I,y,E,S,T,w,N,k,L,C,O,D,R,U,H,P,V,F){let B="";B+='<d class="fast-comments'+(e.readonly?" readonly":"")+(e.useSingleLineCommentInput?" single-line-comment-input":"")+(e.hideAvatars?" hide-avatars":"")+'">';const G=d.length;if(c)B+=m(c);else if(0!==G||!e.readonly||!e.hideCommentsUnderCountTextFormat&&!e.useShowCommentsToggle){i.forEach(e=>{e.widgetTop&&(B+=e.widgetTop(a?a.reviews:null))}),l&&u&&(B+='<d class="fc-red">'+o.t29+"</d>"),g&&(B+='<d class="fc-red is-demo">'+o.t30+"</d>");const t=e.hideCommentsUnderCountTextFormat;if("string"!=typeof t||v){!h||e.readonly||e.inputAfterComments||(B+='<d class="comment-count">',B+=A(e,o,h),B+="</d>"),B+='<d class="top-area">';let t="";for(const e of i)e.getFilterBarHTML&&(t+=e.getFilterBarHTML());if(!0!==e.inputAfterComments&&0===t.length&&(B+=p(e,o,i,s,0,I,y,E,S,T,L,C,null)),e.useShowCommentsToggle&&h>0&&(B+='<d class="comments-toggle toggle-'+(v?"hide":"show")+'-comments">'+z(o,v,h)+"</d>"),v&&(B+=t,b>1)){B+='<div class="select-dir-wrapper">',B+='<div class="select-dir">',B+='<div class="dropdown">';let e="";switch(V){case"OF":e=o.t85;break;case"NF":e=o.t84;break;case"MR":default:e=o.t83}B+='<div class="drop-label">'+e+" <i>▼</i></div>",B+='<div class="items card goes-black">',B+='<div class="dir-drop-btn" data-value="MR">'+o.t83+"</div>",B+='<div class="dir-drop-btn" data-value="NF">'+o.t84+"</div>",B+='<div class="dir-drop-btn" data-value="OF">'+o.t85+"</div>",B+="</div>",B+="</div>",B+="</div>",B+="</div>"}v&&(B+='<d id="new-comments-message-root" data-comment-id="null" class="new-comments-message'+(x?"":" hidden")+'">'+f(o,x)+"</d>"),B+="</d>";let n="";if(-1!==R&&b>H&&P&&(n='<d class="pagination pagination-next"><d class="load-next-page">'+o.t34+"</d>",h<2e3&&(n+='<d class="load-all">'+M(o.t35,h)+"</d>"),n+="</d>"),v){B+='<d class="comments">',e.paginationBeforeComments?B+=n:R>0&&!U.includes(R-1)&&(B+='<d class="pagination pagination-prev"><d class="load-prev-page">'+o.t160+"</d></d>");for(let t=0;t<G;t++){const n=d[t];!0!==n.hidden&&(B+=_(e,o,i,s,r,h,y,I,E,S,w,N,k,T,L,C,O,n,u))}B+="</d>",e.paginationBeforeComments||(B+=n)}!0===e.inputAfterComments&&0===t.length&&(B+=p(e,o,i,s,0,I,y,E,S,T,L,C,null))}else B+='<d class="comments-toggle toggle-show-comments comments-hidden-title">'+t.replace("[count]",h)+"</d>"}return B+='<d class="footer'+(n?" empty":"")+'">',n||(B+='<a href="https://fastcomments.com" target="_blank"> <img alt="Logo" src="https://fastcomments.com/images/logo-32-2020-01'+(e.hasDarkBackground?"-white":"")+'.png" />'+o.t70+"</a>"),B+="</d>",B+="</d>",e.noStyles||(B+=t,i.length>0&&i.forEach(e=>{e.css&&(B+=e.css)})),e.customCSS&&(B+="<style>"+e.customCSS+"</style>"),i.forEach(e=>{e.widgetFilter&&(B=e.widgetFilter(a?a.reviews:null,B))}),B}(u,g,K,he,ke,W,me,we,b,J,k,N,R,D,H,T,ue,ie,ce,de,ae,h,re,ye,se,q,G,B,0,pe,fe,30,P,Ie,Ne.count);if(l.innerHTML){const t=document.createElement("d");t.innerHTML=e;const n=document.createElement("div");n.id=l.id,n.classList=l.classList,n.append(t),V(l,n)}else l.innerHTML="<d>"+e+"</d>";var n,o;s(u.instanceId),Ve(),n=u.instanceId,o=H,t(JSON.stringify({type:"update-comment-count",instanceId:n,count:o}),"*"),u.hideAvatars||document.querySelectorAll(".avatar").forEach(Ue),ke.forEach(e=>{e.onRender&&e.onRender()})}function De(){const e=document.querySelector(".comment-count");e&&(e.innerHTML=A(u,he,H));const t=document.querySelector(".pagination .load-all");t&&(t.innerHTML=M(he.t35,H))}function Re(e){(!e||e&&u.countAll)&&(H++,De())}function Ue(t){t.addEventListener("mouseenter",(function(t){const n=t.target,o=oe(n,"data-comment-id");if(h[o]){const t=h[o].userId;!h[o]._loadingDetails&&t&&(h[o]._loadingDetails=!0,e(u,"GET","/user-stats/"+t+"/?tenantId="+u.tenantId,null,(function(e){if(h[o]._loadingDetails){delete h[o]._loadingDetails;const t=te(o).querySelector(".comment-content");t.innerHTML=t.innerHTML+'<d class="user-details-overlay">'+e+"</d>",setTimeout((function(){t.classList.add("show-user-details-overlay")}),50)}}),(function(){delete h[o]._loadingDetails}),!0))}})),t.addEventListener("mouseleave",(function(e){const t=oe(e.target,"data-comment-id");if(h[t]){delete h[t]._loadingDetails;const e=te(t).querySelector(".comment-content");e.classList.remove("show-user-details-overlay"),setTimeout((function(){const t=e.querySelector(".user-details-overlay");t&&e.removeChild(t)}),200)}}))}function He(){0}function Pe(){const e=Math.max(l.scrollHeight,l.offsetHeight,l.clientHeight);o(u.instanceId,e+(u.ignoreCommentMenuHeight?0:function(e){const t=document.querySelector(".comment .menu .menu-content");if(t){const n=t.getBoundingClientRect().bottom+15;if(n>e)return n-e}return 0}(e)))}function Ve(){Pe(),He()}function Fe(e){const t={};let n;l.querySelectorAll("[data-restore-id]").forEach((function(e){const o=e.attributes.getNamedItem("data-restore-id").value;e.value&&(t[o]=e.value),e===document.activeElement&&(n=o)})),e(),l.querySelectorAll("[data-restore-id]").forEach((function(e){const o=e.attributes.getNamedItem("data-restore-id").value,i=t[o];i&&(e.value=i),n===o&&e.focus()}))}function Be(e,t){const n=te(e._id);Fe((function(){n&&(n.outerHTML=_(u,he,ke,me,we,H,ce,ie,de,ae,re,ye,se,h,q,G,B,e,N)),Ve(),t&&t()})),s(u.instanceId),setTimeout((function(){!function(e){e&&(u.hideAvatars||Ue(e.querySelector(".avatar")))}(n)}),0)}function Ge(e){Fe((function(){const t=te(e._id);t&&(t.querySelector(".comment-vote").innerHTML=v(u,he,re,ye,B,q,e,ce[e._id])),Ve()})),s(u.instanceId)}function qe(){0}function je(e){Fe((function(){const t=null===e||ce[e]?p(u,he,ke,me,0,ie,ce,de,ae,h,q,G,e):"";e?te(e).querySelector(".reply-form-wrapper").innerHTML=t:l.querySelector(".comment-reply.root").outerHTML=t,Ve()})),s(u.instanceId)}function ze(e){var t;!function(e,t,n,o){const i=e.indexOf(o);if(i>-1&&e.splice(i,1),o.parentId&&n[o.parentId]){const e=n[o.parentId].children;if(e){const t=e.indexOf(o);t>-1&&e.splice(t,1)}}else{const e=t.indexOf(o);e>-1&&t.splice(e,1)}delete n[o._id],C(t,n,o.parentId,-1)}(le,b,h,e),O(he,0,h,ye,e.parentId),(!(t=e.parentId)||t&&u.countAll)&&(H--,De())}function We(e){ze(e),Me()}function Ke(){const e=function(){let e=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){const n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?n:3&n|8).toString(16)}))}();return ve.push(e),e}u.hasDarkBackground&&Ce("dark","/js/comment-ui/extensions/comment-ui.dark.extension.min.js",!1),u.enableReviews&&Ce("reviews","/js/comment-ui/extensions/comment-ui.reviews.extension.min.js",!1),u.jumpToHashTag&&Ce("filter-by-hash-tag","/js/comment-ui/extensions/comment-ui.filter-by-hash-tag.extension.min.js",!1),u.extensions&&u.extensions.forEach((function(e){Ce(e.id,e.path,!1)})),window.FastCommentsUI.extensions=ke,0===ke.length&&Ae(),window.addEventListener("resize",He),window.addEventListener("message",(function(e){if(e.data)try{const t=JSON.parse(e.data);if(t.instanceId!==u.instanceId)return;"update-user"===t.type&&JSON.stringify(me)!==JSON.stringify(t.user)&&(me=t.user,Fe(Me))}catch(t){u.apiHost&&console.error(e,t)}}),!1)}window.FastCommentsUI=function(e,t){return ie(e,t,'<style>d { display: block }@keyframes placeHolderShimmer { 0%{ background-position: 0 0 } 100% { background-position: 100% 0 } }.animated-background { animation-duration: 1s; animation-iteration-count: infinite; animation-name: placeHolderShimmer; background: #f6f7f8; background: linear-gradient(to right, #eee 8%, #dddddd 18%, #eee 33%); background-size: 50% 50% }@keyframes backgroundToNormal { from { background: lightblue } to { background: #fff } }.fast-comments { position: relative; width: 100%; font-size: 13px }.hidden { display: none }.inline-block { display: inline-block }.select-dir-wrapper { text-align: right; }.select-dir { display: inline-block; margin: 9px; height: 16px; clear: both }.select-dir .dropdown { position: relative; width: 150px; z-index: 3; text-align: right }.select-dir .dropdown .drop-label { padding: 0 0 3px 0; cursor: pointer; font-weight: 500 }.select-dir .dropdown .drop-label i { position: relative; display: inline-block; top: -2px; font-size: 7px }.select-dir .dropdown .items { position: absolute; display: none; top: 20px; right: 0; width: 100%; overflow: hidden; border-radius: 0 0 4px 4px; }.select-dir .dropdown:hover .items { position: absolute; display: block }.select-dir .dropdown .items .dir-drop-btn { padding: 5px 9px; cursor: pointer; font-weight: 500; text-align: left; font-size: 13px }.new-comments-message { width: fit-content; margin: 20px auto; padding: 5px 10px; text-align: center; cursor: pointer; box-shadow: 0 1px 3px rgba(0, 0, 0, 0.3); border-radius: 4px; font-weight: 500 }.user-details-overlay { position: absolute; opacity: 0; background: #fff; left: -1000px; top: 0; width: 100%; height: 100%; padding: 10px; box-sizing: border-box; pointer-events: none; transition-duration: 350ms }.comment .user-details-overlay > .avatar { display: none }.user-details-overlay .username { font-size: 13px; font-weight: bold }.user-details-overlay .account-created, .user-details-overlay .karma { font-size: 12px; color: #555 }.show-user-details-overlay .user-details-overlay { left: 0; opacity: 1 }.sso-login-wrapper { text-align: center }.sso-login-wrapper .sso-login { display: inline-block; text-decoration: underline; cursor: pointer; font-size: 17px; font-weight: bold }.comment .sso-login-wrapper { padding: 7px 0; text-align: left }.comment .sso-login-wrapper .sso-login { font-size: 14px }.default-hidden { transition-duration: 300ms }.comment-reply:not(.show-default-hidden) .default-hidden, .comment-content:not(.show-default-hidden) > .edit-bottom > div > .default-hidden { height: 0; margin: 0 !important; opacity: 0; pointer-events: none; transition-duration: 200ms }.loader { display: none }.loading .loader { position: absolute; display: block; top: 0; left: 0; width: 100%; height: 100%; z-index: 9; background: rgba(255, 255, 255, 0.5) }.card { border-right: 1px solid #d0d0d0; border-bottom: 1px solid #d0d0d0; background: #fdfdfd; border-radius: 3px; box-shadow: 5px 5px 12px rgba(0,0,0,.1) }button { display: inline-block; margin-bottom: 10px; padding: 4px 10px; border-radius: 5px; font-size: 15px; box-shadow: 0 1px 3px rgba(0, 0, 0, 0.3); background: #fff; color: #000; text-decoration: none; border: none; cursor: pointer }.fast-comments, textarea { font-family: -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif }textarea::placeholder { font-size: 13px; font-weight: 500; transition-duration: 150ms }textarea:focus::placeholder { color: transparent }.fc-red { display: inline-block; margin-top: 3px; color: #ff0000 }.comment-error { padding: 10px }input, textarea { padding: 12px 20px; border: 1px solid #ccc; box-shadow: inset 0 1px 3px #ddd; border-radius: 4px; box-sizing: border-box; outline: none }input:focus, textarea:focus { border-color: #555 }.pagination { position: relative; margin-top: 50px; line-height: 30px; background: #000; color: #fff; text-align: center; cursor: pointer; border-radius: 4px; overflow: hidden; text-shadow: 1px 1px 1px #353535; box-shadow: 0 1px 3px rgba(0, 0, 0, 0.3) }.pagination.pagination-prev { margin-bottom: 20px; }.pagination > * { font-weight: 700; }.pagination > * > span { font-weight: normal; }.pagination > * > span::before { content: "("; }.pagination > * > span::after { content: ")"; }.pagination .load-next-page:hover { background: #fff; color: #000 }.pagination .load-all { position: absolute; top: 0; right: 0; padding: 0 10px; background: #6f6f6f; color: #fff }.pagination .load-all:hover { background: grey; color: #fff }.comments-hidden-title { margin: 20px 0; font-size: 24px; cursor: pointer; font-weight: bold; text-decoration: underline; text-align: center }.comment-count { margin: 10px 0 }.replying-to { margin-bottom: 5px }.comment-reply { position: relative; width: 100%; margin-top: 10px; margin-bottom: 55px }.comment-reply .fast-comments-waiting { display: block; margin: 5px 0 }.comment-reply .logged-in-info { margin-bottom: 5px }.comment-reply .logged-in-info .log-out { font-weight: bold; cursor: pointer; text-decoration: underline }.toolbar { display: inline-block; margin: 5px 0 0 3px; box-shadow: 0 1px 3px rgba(0, 0, 0, 0.3); border-radius: 3px; font-size: 13px; background: #fff }.toolbar .t-btn { display: inline-block; padding: 0 11px; line-height: 35px; vertical-align: middle; cursor: pointer; transition-duration: 200ms }.toolbar .t-btn:hover { background: #eee }.toolbar .t-btn[data-action=bold] { font-weight: bold }.toolbar .t-btn[data-action=ul] { text-decoration: underline }.toolbar .t-btn[data-action=it] { font-style: italic }.toolbar .t-btn[data-action=s] { text-decoration: line-through }.toolbar .t-btn[data-action=code] { padding: 0 6px }.toolbar .img-btn-wrap { position: relative; display: inline-block; padding: 8px 11px; overflow: hidden }.toolbar .t-btn img { width: 18px; cursor: pointer }.toolbar .t-btn[data-action=link] { padding: 10px 11px }.toolbar .t-btn[data-action=link] img { width: 15px; pointer-events: none }.toolbar .t-btn input[type=file] { position: absolute; padding: 40px; font-size: 100px; top: 0; left: 0; opacity: 0; cursor: pointer }@media(max-width: 768px) { .comment .toolbar { min-width: 230px; margin: 5px 1px } }.auth-input { margin: 10px 0; font-size: 13px }.auth-input .fc-red { display: block }.auth-input input { width: 100%; margin-top: 4px; padding: 7px; font-size: 12px }.comment-edit { position: relative; margin: 10px 10px 0 10px; }.comment-edit .comment-text-edit { width: 100%; }.comment-reply textarea { display: block; width: 100%; height: 100px; padding: 5px; resize: none }.comment-reply input.comment-input { display: block; width: 100%; padding: 7px }.comment-reply input[name=fastcomments-link] { display: block; width: 100%; margin: 10px 0; }.comment-reply button { float: right; margin: 5px; padding: 7px 10px }.comment { position: relative; margin-bottom: 15px; clear: both }.comment .inline-image { display: block; max-width: 500px; margin: 3px 0 3px 0 }.comment .inline-image img { max-width: 100%; max-height: 400px }.comment.is-live > .comment-content { animation: backgroundToNormal 1.5s }.comment.unverified > .commenter-name, .comment.unverified > .comment-content .commenter-name { opacity: 0.7 }.comment.unverified > .comment-content > .commenter-name > b::after { content: " | "; font-weight: normal }.comment.unverified > .comment-content > .comment-text { opacity: 0.7 }.comment > .awaiting-approval-notice { margin-bottom: 7px }.comment > .unverified-notice { margin: 5px 0; font-size: 12px }.comment > .unverified-notice:after { content: ":" }.comment > .requires-verification-approval { margin: 3px 0 6px }.comment > .spam-notice { margin: 3px 0; font-size: 12px; color: red }.comment .avatar-wrapper, .comment .avatar { display: inline-block; width: 40px; height: 40px; border-radius: 40px; vertical-align: top }@media(max-width: 500px) { .comment .avatar { vertical-align: middle } }.comment .commenter-name { font-size: 12px }.comment .commenter-name .abs-date { display: inline-block; padding-left: 3px; }.comment .commenter-name .abs-date:before { content: "("; }.comment .commenter-name .abs-date:after { content: ")"; }.comment > .commenter-name { display: none; vertical-align: middle; color: #000 }@media(max-width: 500px) { .comment > .commenter-name { display: inline-block; margin-left: 5px; vertical-align: middle } }.comment > .commenter-name a { display: block; color: #000; text-decoration: none }.comment .commenter-name .website-url { color: #000; text-decoration: underline }.comment .commenter-name .label { font-weight: 500 }.comment > .commenter-name .label { display: block }.comment > .commenter-name .jump-link { color: #5d5b5b }.comment > .comment-content { position: relative; display: inline-block; width: calc(99% - 45px); margin-left: 5px; border: 1px solid #e8e8e8; }@media(max-width: 500px) { .comment > .comment-content { width: 100%; margin: 5px 0 0 0; border: none; box-shadow: none; background: transparent } }.comment > .comment-content .commenter-name { display: inline-block; vertical-align: middle; padding: 5px 10px; color: #171717 }@media(max-width: 500px) { .comment > .comment-content .commenter-name { display: none } }.comment > .comment-content .commenter-name .jump-link { font-weight: 300; text-decoration: none; color: #000 }.comment > .comment-content .commenter-name .label { margin: 0 3px }.comment > .comment-content .comment-text { padding: 5px 10px; color: #000; line-height: 22px; font-size: 14px; word-break: break-word; white-space: pre-line; overflow-y: auto }.comment > .comment-content .comment-text br { line-height: 0.5em }.comment > .comment-content textarea.comment-text, .comment > .comment-content input.comment-text { display: block; width: calc(100% - 20px); height: fit-content; margin: 10px 10px 0 10px; resize: vertical }.comment > .comment-content .edit-failure { display: block; margin: 10px 0; text-align: center }.comment > .comment-content .edit-bottom { margin-bottom: 10px }.comment > .comment-content .edit-bottom > * { display: inline-block; width: calc(50% - 20px); min-width: 200px; margin: 0 10px; vertical-align: top }@media(max-width: 500px) { .comment > .comment-content .edit-bottom > div { width: calc(56% - 20px) } }.comment > .comment-content .edit-actions { margin-top: 5px; text-align: right }@media(max-width: 500px) { .comment > .comment-content .edit-bottom > .edit-actions { width: calc(43% - 20px); min-width: 140px } }@media(max-width: 400px) { .comment > .comment-content .edit-bottom > .edit-actions { width: calc(100% - 20px) } }.comment > .comment-content .edit-actions .edit-cancel { margin-right: 10px }@media(max-width: 500px) { .comment > .comment-content .comment-text { padding: 3px 3px } }.comment > .comment-content .comment-vote { position: relative; margin-left: 8px }@media(max-width: 500px) { .comment > .comment-content .comment-vote { margin-left: 0 } }.comment > .comment-content .comment-vote .vote-awaiting-verification { padding: 5px 0; font-weight: 500 }.comment > .comment-content .toggle-replies { position: absolute; top: 14px; right: 7px; font-size: 11px; cursor: pointer }@media(max-width: 500px) { .comment > .comment-content .comment-vote .toggle-replies { top: 7px; right: 0 } }.comment > .comment-content .comment-vote-options > span { cursor: pointer }.comment > .comment-content .comment-vote-options .fast-comments-upvote.active { color: green }.comment > .comment-content .comment-vote-options .fast-comments-downvote.active { color: red }.comment > .comment-content .comment-vote-options, .comment > .comment-content .comment-votes, .comment > .comment-content .comment-reply-start { display: inline-block; margin: 5px 2px; font-size: 12px }.comment > .comment-content .comment-vote-options button, .comment > .comment-content .comment-reply-start { margin: 0 3px }.comment > .comment-content .comment-vote-auth { width: 100%; max-width: 400px }.comment > .comment-content .comment-vote-auth .fast-comments-waiting { float: left }.comment > .comment-content .comment-vote-auth .buttons { text-align: right }.comment > .comment-content .comment-vote-auth button { margin:5px 0 0 5px }.comment > .comment-content .reply-form-wrapper { padding: 5px }.comment .prompt { position: absolute; top: 0; left: 0; width: 100%; height: 100%; padding: 10px; background: rgba(255, 255, 255, 0.7); text-align: center }.comment .prompt p { font-weight: 500; }.comment .prompt button:not(:last-child) { margin-right: 10px }@media(max-width: 500px) { .comment .prompt { padding: 5px } }@media(max-width: 500px) { .comment .prompt p { margin: 0 0 .4em 0 } }.comment .top-right { position: absolute; top: 0; right: 0 }.comment .top-right:hover { z-index: 9001; }@media(min-width: 500px) { .comment > .top-right { display: none } }@media(max-width: 500px) { .comment > .comment-content .top-right { display: none } }.comment .top-right > * { display: inline-block; vertical-align: middle }.comment .top-right .pin { width: 20px; padding-top: 5px }.comment .menu { padding: 10px; user-select: none }.comment > .menu { top: 10px; right: 0 }.comment .menu .menu-btn { cursor: pointer }.comment .menu .menu-btn i { display: inline-block; width: 4px; height: 4px; margin: 2px; background: #333; border-radius: 10px }.comment .menu .menu-content { display: none; position: absolute; top: 23px; right: 10px; width: 110px; padding: 5px; background: #fff }.comment .menu .menu-content div { padding: 3px; font-weight: 500; cursor: pointer; font-size: 13px }.comment .menu .menu-content div > * { pointer-events: none; }.comment .menu:hover { z-index: 9001; }.comment .menu:hover .menu-content { display: block }ul, ol { line-height: 14px; }.comment > .children { margin: 15px 0 0 15px }@media(max-width: 768px) { .pagination .load-next-page { padding-left: 10px; text-align: left } }.footer { height: 55px; margin-top: 70px; padding-top: 10px; text-align: center; font-size: 12px; border-top: 1px solid #ccc } .footer a, .footer img { vertical-align: baseline; text-decoration: none; color: #201600; font-weight: bold; font-size: 14px } .footer img { position: relative; top: 14px; left: -2px; display: inline; width: 25px; padding-left: 5px } .dark { color: #fff }.dark textarea, .dark input { background: transparent; color: #fff; box-shadow: none }.dark textarea::placeholder, .dark input::placeholder { color: #fff }.dark .toolbar { box-shadow: none; background: transparent; color: #fff }.dark .toolbar .t-btn:hover { background: #000; border-radius: 4px }.dark .toolbar img { filter: invert(1) }.dark button, .dark .comment-reply button { box-shadow: none; background: transparent; color: #fff }.dark .card { box-shadow: none; border: none }.dark .card.goes-black { background: #000; border: 1px solid #fff; border-radius: 4px }.dark .comment > .comment-content { background: transparent }.dark .comment .comment-text, .dark .comment .comment-text a, .dark .comment .commenter-name, .dark .comment .commenter-name .jump-link, .dark .comment > .commenter-name a { color: #fff }.dark .comment .menu .menu-btn i { background: #fff }.dark .comment .prompt { background: rgba(0, 0, 0, 0.7) }.dark .user-details-overlay { background: #000 }.dark .user-details-overlay > * { color: #fff }.dark .footer a { color: #fff }.comment.readonly .comment-vote-options { display: none }.search-list { position: absolute; z-index: 4; width: 100%; margin-top: -9px; box-sizing: border-box; border-radius: 0 0 11px 11px; background: #fff; border: 1px solid #bfbfbf; }.search-list .cross { background: url("/images/svg/v2/close.svg") no-repeat center; background-size: 9px 9px; display: inline-block; vertical-align: middle; image-rendering: -webkit-optimize-contrast; position: absolute; top: -11px; right: 0; width: 20px; height: 20px; background-color: #fff; border: 1px solid #bfbfbf; border-right: 0; border-radius: 16px 0 0 16px; cursor: pointer; }.search-list .search-entry { padding: 5px 10px; cursor: pointer; }.search-list .search-entry.last { border-radius: 0 0 11px 11px }.search-list .search-entry img { width: 20px; height: 20px; margin-right: 3px; vertical-align: middle; border-radius: 20px; }.search-list .search-entry > * { pointer-events: none; }.search-list .search-entry:hover, .search-list .cross:hover { background-color: #eee; }</style>')};